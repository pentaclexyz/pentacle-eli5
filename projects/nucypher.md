Cryptographic infrastructure for privacy-preserving applications